//this function will handle client communication with the server
var clientSetup = function() {
		//create() is moved here to make sure nothing is created before uniq id assignation
		create();

<% @players.uniq.each do |x| %>
  spawnPlayer('<%= x %>');
<% end %>
}

var goleft = function(i) {
    playersList[i].dude.x -= 5;
    playersList[i].dude.animations.play('left');
  }
var goright = function(i) {
    playersList[i].dude.x += 5;
    playersList[i].dude.animations.play('right');
  }
var goup = function(i) {
    playersList[i].dude.y -= 5;
    playersList[i].dude.animations.play('up')
  }
var godown = function(i) {
    playersList[i].dude.y += 5;
    playersList[i].dude.animations.play('down')
  }

var width = $('#gamescreen').innerWidth() - 50;
var height = $('#gamescreen').innerHeight();
var game = new Phaser.Game(width, height, Phaser.AUTO, 'gamescreen', { preload: preload, create: clientSetup, update: update, render: render });

function preload() {
    game.load.tilemap('level',"assets/tilemap.json",null, Phaser.Tilemap.TILED_JSON);
    game.load.image('tiles',"assets/hyptosis_tile-art-batch-1.png");
    game.load.spritesheet('dude',"assets/brandonTile.png",14,21);
}