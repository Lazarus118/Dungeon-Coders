//this function will handle client communication with the server
var clientSetup = function() {
		//create() is moved here to make sure nothing is created before uniq id assignation
		create();

<% if @players %>
  <% @players.uniq.each do |x| %>
    <% if x != @thisplayer %>
      spawnPlayer('<%= x %>');
    <% end %>
  <% end %>
<% end %>
  playersList[player] = player;
}

var goleft = function(i) {
    playersList[i].dude.body.x -= 5;
    playersList[i].dude.animations.play('left');
  }
var goright = function(i) {
    playersList[i].dude.body.x += 5;
    playersList[i].dude.animations.play('right');
  }
var goup = function(i) {
    playersList[i].dude.body.y -= 5;
    playersList[i].dude.animations.play('up')
  }
var godown = function(i) {
    playersList[i].dude.body.y += 5;
    playersList[i].dude.animations.play('down')
  }

var killMe = function(i) {
        console.log('KILL');
	      playersList[i].alive = false;
	      playersList[i].kill();
}

var width = $('#gamescreen').innerWidth() - 50;
var height = $('#gamescreen').innerHeight();
var game = new Phaser.Game(width, height, Phaser.AUTO, 'gamescreen', { preload: preload, create: clientSetup, update: update, render: render });

function preload() {
    game.load.tilemap('level',"assets/tileset/tilemap.json",null, Phaser.Tilemap.TILED_JSON);
    game.load.image('tiles',"assets/tileset/hyptosis_tile-art-batch-1.png");
    game.load.spritesheet('dude',"assets/tileset/brandonTile.png",14,21);
}